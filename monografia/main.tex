\documentclass[a4paper,11pt]{article}
\usepackage[left=3cm,top=3cm,right=2cm,bottom=2cm]{geometry}
\usepackage[brazilian, english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[numbers]{natbib}
\usepackage{epigraph}
\usepackage{indentfirst}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{setspace}
\usepackage[hidelinks]{hyperref}
%\usepackage{xcolor}
\usepackage[dvipsnames]{xcolor}
\usepackage{adjustbox}
\newcommand{\tabitem}{~~\llap{\textbullet}~~}
\newcommand*{\SignatureAndDate}[4]{%
	\parbox{7cm}{
      \centering
      \rule{6cm}{1pt}\\
       #1

       #2
    }
    \hfill
\parbox{7cm}{
      \centering
      \rule{6cm}{1pt}\\
       #3

       #4
    }
}%
\usepackage{float}

\floatstyle{ruled}
\newfloat{program}{thp}{lop}
\floatname{program}{Program}

\onehalfspacing

\title{Relatório de Estágio III}

\renewcommand{\familydefault}{\sfdefault}

\begin{document}
\selectlanguage{brazilian}

%%% CAPA %%%

\begin{titlepage}

\begin{wrapfigure}[2]{l}{0.2\textwidth}
	\label{Logo UFABC}
	\vspace{-1\baselineskip}
	\centering
	\includegraphics[width=0.25\textwidth]{images/Logo_UFABC}
\end{wrapfigure}

\uppercase{Universidade Federal do ABC}

\uppercase{Bacharelado em Ciência da Computação}

\vfill
\begin{center}

\uppercase{\textbf{Projeto de Graduação em Computação}}

\vfill

\uppercase{Bruno Cesar Porto de Arruda}
\vspace{1cm}

Orientador: Prof. Dr. Vladimir Moreira Rocha

\vfill

Santo André -- SP

2019
\end{center}
\end{titlepage}

%%% FIM DA CAPA %%%

%%% FOLHA DE ROSTO %%%

\begin{titlepage}
\begin{center}
\uppercase{\textbf{Bruno Cesar Porto de Arruda}}

\vfill

\uppercase{\textbf{Um sistema distribuído com permissão de acesso a prontuários de pacientes por meio de Smart Contracts}}
\end{center}

\vfill

\hfill \begin{minipage}{0.5\textwidth}
Trabalho submetido à Universidade Federal do ABC como parte dos requisitos para a conclusão do Bacharelado em Ciência da Computação.
\vspace{1cm}

Orientador: Prof. Dr. Vladimir Moreira Rocha
\end{minipage}

\vfill

\begin{center}
Santo André -- SP

2019
\end{center}
\end{titlepage}

%%% FIM DA FOLHA DE ROSTO %%%

\begin{center}
\uppercase{\textbf{Dedicatória}}
\end{center}
	xxx.


\newpage
\begin{center}
\uppercase{\textbf{Agradecimentos}}
\end{center}

\noindent	Ofereço meus sinceros agradecimentos:

\vspace{1cm}


%%% ABSTRACT - PORTUGUÊS %%%
\newpage
\begin{abstract}

\noindent FAZER NO FINAL.\\

\noindent \textbf{Palavras-Chave:} Blockchain; Ethereum; Contratos Inteligentes; CBA.
\end{abstract}

%%% ABSTRACT - INGLÊS %%%

\newpage
\selectlanguage{english}
\begin{abstract}
\noindent FAZER NO FINAL. \\

\noindent \textbf{Keywords:} Blockchain; Ethereum; Smart Contracts; ABE.
\end{abstract}

\selectlanguage{brazilian}

%%% SUMÁRIO %%%
\newpage
\tableofcontents

%%% LISTA DE FIGURAS %%%
\newpage
\listoffigures

%%% LISTA DE TABELAS %%%

% \newpage
% \listoftables

% -------------------------------------------------------------------- %
\newpage
\section{Introdução}

A tecnologia Blockchain~\cite{nakamoto2008bitcoin}...

\subsection{Objetivo geral}

Criar um sistema, com base em contratos inteligentes executados em uma Blockchain, que permita o acesso a prontuários eletrônicos dos pacientes via políticas de acesso baseadas em atributos.

\subsection{Objetivos específicos}

\begin{itemize}

\item Criar uma taxonomia de permissões no contexto de saúde.

\item Analisar como funciona a criptografia baseada em atributos (\textit{attribute-based encryption}, em inglês).

\item Analisar como funcionam a tecnologia Blockchain {\color{red}escolher a tecnologia} e os contratos inteligentes.

\item Implementar os contratos inteligentes para dar acesso aos prontuários eletrônicos utilizando a taxonomia e a criptografia baseada em atributos.

\item Implantar e executar os contratos inteligentes em uma arquitetura Blockchain.

\end{itemize}

\subsection{Justificativa}

% -------------------------------------------------------------------- %
\newpage
\section{Fundamentação Teórica}

\begin{itemize}
    \item {\color{red}Cada parágrafo deve ter em torno de 10 linhas}
    \item {\color{red}Não mostrar código.}
\end{itemize}

\subsection{Criptografia baseada em atributos (CBA)}

{\color{ForestGreen}Explicar quando nasceu, quem a criou, e qual foi o problema que estava resolvendo (basicamente que a criptografia chaves publica/privada precisa ser criada para cada usuário que precisa de permissão e com a por atributos não). (2 parágrafos).} \\

{\color{ForestGreen}Explicar alguns conceitos da CBA (chave pública/privada/etc para que sirva como base do exemplo mostrado no último parágrafo (1 parágrafo).} \\

{\color{ForestGreen}Explicar os benefícios do CBA (2 parágrafos).} \\

{\color{ForestGreen}Explicar um exemplo de uso (1 parágrafo). Pode usar algo assim: https://medium.com/asecuritysite-when-bob-met-alice/towards-true-security-attribute-based-encryption-20d5799aeda6} \\

\subsection{Blockchain Ethereum}

{\color{ForestGreen}Explicar quando nasceu, quem a criou e que resolve o problema de não estar atrelada somente a transações financeiras, tendo um uso mais abrangente para qualquer domínio de aplicação. (2 parágrafos).} \\

{\color{ForestGreen}Explicar o que é (distributed ledger, cadeia de blocos, transação) e suas características (anonimato, imutabilidade, distribuição). (2 parágrafos).} \\

{\color{ForestGreen}Explicar que para criar o consenso, ou seja, escolher quem irá inserir o último bloco na cadeia, é necessário utilizar o mecanismo de consenso denominado Proof-of-Work (PoW). Explicar em que consiste o PoW. (2 parágrafos).} \\

\subsection{Contratos inteligentes no Ethereum}

{\color{ForestGreen}Explicar para que servem e listar benefícios. (1 parágrafo).} \\

{\color{ForestGreen}Explicar o código de um contrato simples que terá o atributo idPaciente, um map de urls de registros médicos e um método addUrl. (1 parágrafo).} \\

\lstset{basicstyle=\small, numbers=left, language=bash, keywordstyle=\color{blue}, numbersep=2pt, label={lst:modelo}, caption={Exemplo de Contrato Inteligente}}
\begin{lstlisting}
classe Registro {
   int version;
   string result;
   string data;
   DateTime MinTime;
   DateTime MaxTime;
   string extHash;
}
\end{lstlisting}


{\color{ForestGreen}Explicar um exemplo passo-a-passo (Só TEXTO, Não Código) de um cliente que obtém o contrato do parágrafo anterior e o executa remotamente em uma máquina. (2 parágrafo).} \\


% -------------------------------------------------------------------- %
\newpage
\section{Sistema Proposto}

\begin{itemize}
    \item {\color{red} Assuma nesta sessão que os conceitos de blockchain, Ethereum, contratos inteligentes e criptografia baseada em atributos já foram definidos e explicados.}

    \item {\color{red}Cada parágrafo deve ter em torno de 10 linhas}

    \item {\color{red}Não mostrar código.}

\end{itemize}

\subsection{Visão Geral}

{\color{ForestGreen}Explicar que o sistema é composto por X componentes (1 parágrafo).} \\

O protótipo pode ser abstraído em diferentes módulos de acordo com sua capacidade. A criptografia no esquema ABE é realizada por meio da biblioteca DCPABE. A conectividade com a Blockchain Ethereum é feita por uma classe específica por meio da biblioteca Web3j. A lógica de execução que coordena as atividades entre os usários do sistema está encerrada em sua maior parte no módulo denominado como Cliente, e em menor parte nos smart contracts que são executados na EVM do Ethereum. Finalmente, o servidor de arquivos pode ser visto como o quinto módulo do sistema. \\

{\color{ForestGreen}Explicar a função de cada componente (1-2 parágrafos para cada um).} \\

O módulo do cliente é responsável por incorporar a camada lógica responsável por coordenar as atividades entre os demais componentes.\\

O módulo do servidor recebe, armazena e envia arquivos criptografados. Presumiu-se que o servidor não fosse confiável, e por isso as informações nele estão sempre criptografadas. Durante os testes, ele também armazenou, de forma temporária, chaves criptográficas que representam a posse de um atributos. Essa função poderia ser transferida para qualquer serviço de transferência de arquivos, como um servidor dedicado sob controle do certificador, um serviço de hospedagem em nuvem ou mesmo por e-mail.\\

O módulo blockchain é responsável por armazenar de forma permanente e imutável a cifra de um documento, e a política de acesso descrita em termos de uma forma booleana composta por funções lógicas E e OU aplicadas a atributos. A Blockchain para desenvolvimento e teste do protótipo foi uma rede privada do Ethereum.\\

Também é necessário que a blockchain tenha a capacidade de executar smart contracts, e por isso a rede Bitcoin não foi escolhida para este trabalho. Há muitas opções de projetos de blockchain que suportam smart contracts, e a rede Ethereum foi escolhida por ser o projeto mais popular e bem sucedido no tocante à base de usuários e também ao valor de mercado.\\

Em conjução com a blockchain Ethereum, foi utilizado a biblioteca Web3j para conectar o cliente à rede privada. O Web3j fornece a interface para a conexão por meio de socket a um provedor de dados da rede blockchain, que pode ser tanto uma rede local, um cliente ethereum como o geth ou um serviço de terceiros como o Infura. Além disso, fornece implantação de contratos inteligentes, invocação de métodos destes contratos e classes geradas dinamicamente.\\

{\color{ForestGreen}Figura dos principais componentes em alto nível: programa cliente (exemplo celular ou notebook), servidor de armazenamento de arquivos; blockchain ethereum; contratos inteligentes; servidor de chaves de permissões.} \\

{\color{ForestGreen}Explicar um cenário de uso passo-a-passo (exemplo, milestone 1, mas com permissões direcionadas ao contexto de saúde, por exemplo um paciente quer dar permissão de acesso a médicos cardiologistas) (2 parágrafos)}.

O protótipo funcionaria então da seguinte forma: Uma paciente de nome Alice receberia um documento digital, como um encaminhamento ou exame, e precisa juntar ele ao seu prontuário médico. Ela utiliza o então o módulo cliente para criptografar este documento de forma segura usando um esquema criptográfico ABE, aplicado ao documento para cifrá-lo de acordo com uma política de acesso. Para este caso de uso, suponhamos que a tal política seja "paciente OU (Hospital-X E Hematologista)". Isso garante acesso ao próprio paciente e aos médicos daquele especialidade, naquele hospital. \\

Após aplicar criptografia ao documento, simultaneamente o cliente encaminha o documento para um servidor de arquivos e publica os parâmetros da cifra na blockchain, informando além dela informações como o nome do arquivo, o instante da transação e uma referência ao servidor onde o arquivo está alocado. Em um segundo momento, um hematologista do Hospital X, ciente de que atenderá a Alice, usa o cliente para obter informações sobre que arquivos dela estão disponíveis na blockchain. Ao baixar a descrição dos arquivos, ele identifica qual possui uma política de acesso compatível com os atributos concedidos a ele, e então ele requisita o documento cifrado ao servidor de arquivos e decifra o documento utilizando os parâmetros criptográficos publicados na blockchain.

\subsection{Taxonomia de permissões}

{\color{ForestGreen}Explicar que o servidor de permissões deverá ser responsabilidade de uma organização apta para entregar as permissões online (ex. Ministério de Saúde ou algúm conselho federal/regional de medicina) (1 parágrafo)}. \\

{\color{ForestGreen}Explicar que a autenticação de uma pessoa para obter a permissão deverá ser realizada de forma externa ao sistema proposto (1 parágrafo).} \\

{\color{ForestGreen}Explicar que foi realizada uma taxonomia das possíveis permissões que seriam utilizadas no sistema para o contexto médico. (3 parágrafos explicando como foi realizado o levantamento, me lembro que tinha um artigo e uma lista gigante que foi filtrada por quantidade de médicos).} \\

{\color{ForestGreen}Figura da taxonomia}. \\

{\color{ForestGreen}Explicar que no sistema proposto existe um servidor de atributos ao qual se pedem as chaves públicas/privadas para realizar a encriptação/decriptação (1 parágrafo).} \\

{\color{ForestGreen}Explicar como é realizado o passo-a-passo para o pedido/entrega das chaves (note que aqui a descrição é muito mais profunda que o que foi mencionado na visão geral) (1 parágrafo).}

\subsection{Contratos inteligentes com CBA}

\subsection{Arquitetura Blockchain}

% -------------------------------------------------------------------- %
\newpage
\section{Trabalhos Relacionados}

\subsection{Sistemas de saúde com Blockchain e CBA}

\subsection{Sistemas de saúde com CBA}
\label{sub:sec:saude-cba}

\subsection{Sistemas gerais com CBA}

Caso não hajam trabalhos na sessão~\ref{sub:sec:saude-cba}.

% -------------------------------------------------------------------- %
\newpage
\section{Resultados Experimentais}



% -------------------------------------------------------------------- %
\newpage
\section{Conclusões e Trabalhos futuros}

\bibliography{doc}
\bibliographystyle{plainnat}


\end{document}
